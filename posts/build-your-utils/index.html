<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-post-template-jsx.e3898ebf0382d24403ff.css">/*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 2.5rem}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 .125rem;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}html{font-size:100}body{color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:500}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:26px;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:500}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.layout{max-width:66.875rem;margin-left:auto;margin-right:auto}.layout:after,.layout:before{content:"";display:table}.layout:after{clear:both}.content__inner{padding:1.5625rem 1.25rem}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}.content{width:calc(58.275% - .78125rem)}.content:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.content:last-child{margin-right:0}.content:nth-child(12n){margin-right:0;float:right}.content:nth-child(12n+1){clear:both}.content__inner{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.content{width:calc(66.6% - .625rem)}.content:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.content:last-child{margin-right:0}.content:nth-child(3n){margin-right:0;float:right}.content:nth-child(3n+1){clear:both}.content__inner{padding:2.5rem 2.1875rem}}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.tags__list-item-link{color:#222}.tags__list-item-link:focus,.tags__list-item-link:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.categories__list-item-link{color:#222}.categories__list-item-link:focus,.categories__list-item-link:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.post-single__inner{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.post-single__title{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.post-single__body figure{margin-bottom:1.625rem}.post-single__body figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.post-single__body figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.post-single__body a{text-decoration:underline}.post-single__body .gatsby-highlight{max-width:40rem;margin-left:.9375rem;margin-right:.9375rem;margin-bottom:1.625rem}.post-single__body :not(div){max-width:40rem;margin-left:auto;margin-right:auto}.post-single__footer{max-width:40rem;line-height:1.625rem;margin:1.625rem .9375rem 3.25rem}.post-single__footer-text a{text-decoration:underline}.post-single__date{max-width:40rem;margin-left:auto;margin-right:auto}.post-single__tags{margin-bottom:.8125rem}.post-single__tags-list{list-style:none;margin:0 -.3125rem;padding:0}.post-single__tags-list-item{display:inline-block;margin:.625rem .3125rem}.post-single__tags-list-item-link{background:#ebebeb;text-decoration:none;border:0;border-radius:.1875rem;color:#555;line-height:1.625;padding:.5rem 1rem}.post-single__tags-list-item-link:focus,.post-single__tags-list-item-link:hover{color:#222;background:#dfdfdf;border:0}.post-single__home-button{display:block;margin-left:auto;margin-right:auto;max-width:5.625rem;font-size:1rem;padding:0 1rem;height:35px;line-height:2.1875rem;text-align:center;color:#555;background:#ebebeb;font-weight:400;border-radius:.1875rem;margin-top:1.625rem}.post-single__home-button:focus,.post-single__home-button:hover{color:#222;background:#dfdfdf;border:0}@media screen and (min-width:685px){.post-single__body .gatsby-highlight,.post-single__footer{margin-left:auto;margin-right:auto}}@media screen and (min-width:960px){.post-single__inner{padding:0}.post-single__title{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.post-single__body,.post-single__body p{font-size:1.5rem;line-height:2.4375rem;margin-bottom:1.82813rem}.post-single code{font-size:1.25rem;line-height:2.03125rem}.post-single__home-button{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.0.22"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,700" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Build your own utils - Blog by Valerii Maltsev</title><meta data-react-helmet="true" name="description" content="Only you the one who knows how you like to use the code"/><link as="script" rel="preload" href="/component---src-templates-post-template-jsx-e87a5a16591bd660b46f.js"/><link as="script" rel="preload" href="/app-f7560001493a17b1aff9.js"/><link as="script" rel="preload" href="/3-33c210f6aea9be8bdf5b.js"/><link as="script" rel="preload" href="/0-b8503e2c4e230276dc09.js"/><link as="script" rel="preload" href="/webpack-runtime-5956b358f1db043dc6af.js"/><link rel="preload" href="/static/d/903/path---posts-build-your-utils-0-d-1-df8-aT9JdVinklRjgBL9smkka0gxg.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="layout"><div><div><div><a class="post-single__home-button" href="/">All Articles</a></div><div class="post-single"><div class="post-single__inner"><h1 class="post-single__title">Build your own utils</h1><div class="post-single__body"><h2>Preface</h2>
<p>This little talk is about how it is important to build your own tools, build wrappers
for third party dependencies of the application code. How it is important to isolate your application
code from anything else.</p>
<blockquote>
<p>“Nobody knows exactly how do you like to use the code, except yourself.” - Me</p>
</blockquote>
<p>Your applaction code should contain facades for you dependency’s code. It can be considered as
a rule in a project - ‘use wrapper for dependency’. Doesn’t matter what kind of dependency it is.
It can be helper library to work with arrays and objects or it can be a UI library of components.</p>
<p>In order to bring some arguments here lets consider regular app’s code that doesn’t use wrappers.
First you decided to use ‘OneUI’ (just example) library for components like input, select, button etc.
You built several pages and ten forms which all the way use this components directly imported
from ‘OneUI’ module. Then UX designer came and modify your app in the way, that it is easier to choose
another ‘TwoUI’ lib in order to support nice UX and performance. Or maybe even write your own
components. In that point you began to think about hundred of places where you imported old
‘OneUI’ library and started to imagine how painful it is going to be reimplementing all components with new ‘TwoUI’ library.</p>
<p>Now think about how much it is easier to replace old library with new one if you just need to update
your code in modules that expose particular components and don’t touch your application code? E.g. just
import ‘TwoUI’ instead of ‘OneUI’ to Input module and change implementation in one place. This way
you can incrementally replace components in your app one by one and not be lost in ‘where I can miss to replace components?‘.</p>
<h2>Making utils</h2>
<p>There is a bunch of code that involved in data processing. E.g. traversing lists of data, mutating / creating objects. Often for
that purpose developers use third party libraries like <a href="https://lodash.com/">lodash</a> or <a href="https://ramdajs.com/">ramda</a> or smth else.</p>
<p>Through the article I’m using examples with <code class="language-text">ramda</code> just because I’m using it a lot in my day to day coding. The thing that it is more suitable for functional programming is another
topic which I think I’ll cover soon. So for purpose of exposing
main ideas in the current article I’ll add brief descriptions
to some <code class="language-text">ramda</code> code.</p>
<p>In your application finding an item by specific id can look like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> found <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token comment">// check if specific predicate returns True for input item, and return that item</span>
  _<span class="token punctuation">.</span><span class="token function">propEq</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'specific id to look up'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// accept property name, property value and an object which should be checked</span>
  list<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>If you are not familiar with <code class="language-text">partial function application</code> then
check how previous code snipped could look without it:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> found <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">propEq</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'specific id to look up'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
  list<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">Partial application</code> is one of the fundamental tool that makes
functional programming possible with JavaScript. If you interested check <a href="https://fr.umio.us/favoring-curry/">this one</a>. But there we won’t cover it in details. I’ll use such examples
in the article just because it looks better, without characters that decrease readability =)</p>
<p>So lets make our utils right from here!
Code, shown above likely often faced in the application in different places. But you can create your
<code class="language-text">findById</code> util function:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// utils/list.js</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token comment">// findById :: ID -> Array Object -> Object</span>
<span class="token keyword">const</span> <span class="token function-variable function">findById</span> <span class="token operator">=</span> id <span class="token operator">=></span> _<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">propEq</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">findById</code> takes value of id, then list where we want to find
an item and returns item or <code class="language-text">undefined</code> if there is no such item in the list.</p>
<p><a href="https://codesandbox.io/s/wizardly-cohen-9zlfm">Codesandbox</a></p>
<p>Feel free to use it everywhere in the app! Now you can not only use it but improve it or extend it.
This way it is even make it easy to change the third party library. Just edit your utils and don’t touch other
app’s code. Cool!</p>
<p>The next one I’ve used a lot is mapping lists. For example we often map list to make list of ids from list of objects. With direct usage of library you can write it like that:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// app/code.js</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ids <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Lets “util” it!</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// utils/object.js</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Get "id" from object.
 * @example
 * const objId = id(obj);
 */</span>
<span class="token keyword">const</span> id <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// takes property name and object, return property value</span>

<span class="token comment">// utils/list.js</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./object'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mapId <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// apply specific function to every item of the list, passed as a second argument</span></code></pre></div>
<p>The next one I’ve used a lot is filtering items that has <code class="language-text">undefined</code> or <code class="language-text">null</code> values. With direct usage of the library
you can write it like that:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// app/code.js</span>

<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> filtered <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token comment">// takes predicate and return new list with items that sutisfied this predicate</span>
  _<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span> <span class="token comment">// just make one function from other ones</span>
    _<span class="token punctuation">.</span><span class="token function">either</span><span class="token punctuation">(</span> <span class="token comment">// return True if at least one of args return True</span>
      _<span class="token punctuation">.</span>isNil<span class="token punctuation">,</span> <span class="token comment">// check if value is undefined or null</span>
      _<span class="token punctuation">.</span>isEmpty<span class="token punctuation">,</span> <span class="token comment">// check if value is empty, e.g. "" or [] or {}</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    _<span class="token punctuation">.</span>not<span class="token punctuation">,</span> <span class="token comment">// reverce True to False and vise versa</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  list<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token keyword">const</span> filtered <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span> <span class="token comment">// opposed to filter</span>
  _<span class="token punctuation">.</span><span class="token function">either</span><span class="token punctuation">(</span>
    _<span class="token punctuation">.</span>isNil<span class="token punctuation">,</span>
    _<span class="token punctuation">.</span>isEmpty<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  list<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token keyword">const</span> filtered <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will filter also zeros which is not ok for some cases</span></code></pre></div>
<p>There is first filter function without third party library just to get you an idea how it works:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// app/code.js</span>

<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> filtered <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token comment">// takes predicate and return new list with items that sutisfied this predicate</span>
  <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> invalid <span class="token operator">=</span> <span class="token punctuation">(</span>
      item <span class="token operator">===</span> undefined
      <span class="token operator">||</span> item <span class="token operator">===</span> <span class="token keyword">null</span>
      <span class="token operator">||</span> item<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span>
      <span class="token operator">||</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span>
      <span class="token operator">||</span> item <span class="token operator">===</span> <span class="token string">''</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">!</span>invalid<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  list<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>So much functions in so frequently used logic! Have to do smth with it. Yeap, right. Make util for it:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// utils/list.js</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> clear <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">either</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>isNil<span class="token punctuation">,</span> _<span class="token punctuation">.</span>isEmpty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Here is another <code class="language-text">ramda</code>’s function <code class="language-text">adjust</code>. What does it do? It applies specific function to list item under specific index.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token comment">// app/code.js</span>
  <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> index <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>item <span class="token operator">=></span> item <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> adjusted <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">adjust</span><span class="token punctuation">(</span> <span class="token comment">// apply first argument to list item under index from second argument</span>
    _<span class="token punctuation">.</span>inc<span class="token punctuation">,</span> <span class="token comment">// increase input number by 1</span>
    index<span class="token punctuation">,</span>
    list<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [2, 2]</span></code></pre></div>
<p>The main inconvenience for me was that I need to calculate index of the item I want to update.
It can be improved by providing your own <code class="language-text">adjustBy</code> function! Look:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token comment">// utils/list.js</span>
  <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">adjustBy</span> <span class="token operator">=</span> <span class="token punctuation">(</span>applyF<span class="token punctuation">,</span> findF<span class="token punctuation">,</span> list<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">adjust</span><span class="token punctuation">(</span>
      applyF<span class="token punctuation">,</span>
      _<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>findF<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// find index of an intem by specific predicate</span>
      list<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  <span class="token comment">// app/code.js</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> adjustBy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../utils/list.js'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> adjusted <span class="token operator">=</span> <span class="token function">adjustBy</span><span class="token punctuation">(</span>
    inc<span class="token punctuation">,</span> <span class="token comment">// set 'id' property to 3</span>
    _<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// check if item's 'id' property equals 2</span>
    list<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [2, 2]</span></code></pre></div>
<p>So neet!</p>
<p>Now, instead of separately find index and then apply <code class="language-text">adjust</code> function we can do all this steps in
one function call. Cool! One more our own util.</p>
<p>This way you can create your own domain specific language on top of your host programming language.
What do I mean? Imagine we have an app with cart and items that can be placed in the cart. Now you
need to add item to the cart. In the simplest structure it looks like that:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> cart <span class="token operator">=</span> <span class="token punctuation">{</span> items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'food'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// add item to the cart and return new cart object (immutability is important =))</span>
  <span class="token keyword">const</span> newCart <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>cart<span class="token punctuation">,</span> items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>cart<span class="token punctuation">.</span>items<span class="token punctuation">,</span> item<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Ok. I don’t want to write this code twice anywhere in my app code. So I’m going what? Right! Util it!</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token comment">// utils/cart.js</span>
  <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>
  
  <span class="token keyword">const</span> <span class="token function-variable function">addItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span>cart<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">assoc</span><span class="token punctuation">(</span> <span class="token comment">// set property value to object and return new object</span>
      <span class="token string">'items'</span><span class="token punctuation">,</span>
      _<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> cart<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// add item to the end of list</span>
      cart<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// app/code.js</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> addItem <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../utils/cart.js'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> cart <span class="token operator">=</span> <span class="token punctuation">{</span> items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'food'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> newCart <span class="token operator">=</span> <span class="token function">addItem</span><span class="token punctuation">(</span>cart<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Not so hard, right? But how exciting our code could look like!</p>
<p>You can achieve great readability and maintainability this way but don’t be lazy to do this from
the start, so you don’t neet to improve your code in the future =)</p>
<p>One more huge positive effect of “utiling” is portability of the code. This days it is common
to write web and mobile applications for clients, maybe even browser extention.
And the easiest way to reduce time spending on
development is to reuse your own code. All utils you built you can now port to different places.
Just made different repository for all utils have been made and reuse them everywhere!
At the end you just need to write platform specific code, which in most cases deals with UI, API calls
and caching on device side. But at least you can store business logic and utils shareable.</p>
<p>Lets check what we can “util” when working with React application. There is lot of interesting
stuff to do! Lets think about most commonly used way we work with JSX and components. Lets cover common case of using ternary operator inside JSX code. For me it is hard to
read and manipulate if it has lot of JSX. Just for illustration, ternary code can look like that:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  (a &lt; b) ? (
    &lt;ComponentForTruthy /&gt;
  ) : (
    &lt;ComponentForFalsy /&gt;
  )
}</code></pre></div>
<p>I’d like to replace it with more semantic one. Lets build <code class="language-text">IfElse</code> component.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;IfElse condition={a &gt; b}&gt;
  &lt;IfElse.T&gt;&lt;ComponentForTruthy /&gt;&lt;/IfElse.T&gt;
  &lt;IfElse.F&gt;&lt;ComponentForFalsy /&gt;&lt;/IfElse.T&gt;
&lt;/IfElse&gt;</code></pre></div>
<p>That will be widely used util for sure.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> <span class="token function-variable function">IfElse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> condition<span class="token punctuation">,</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>condition <span class="token operator">&amp;&amp;</span> child<span class="token punctuation">.</span>type <span class="token operator">===</span> IfElse<span class="token punctuation">.</span><span class="token constant">T</span><span class="token punctuation">)</span> <span class="token keyword">return</span> child<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>condition <span class="token operator">&amp;&amp;</span> child<span class="token punctuation">.</span>type <span class="token operator">===</span> IfElse<span class="token punctuation">.</span><span class="token constant">F</span><span class="token punctuation">)</span> <span class="token keyword">return</span> child<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  IfElse<span class="token punctuation">.</span><span class="token function-variable function">T</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> children<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  IfElse<span class="token punctuation">.</span><span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> children<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Now we can use it and even extend it for supporting cases like this (declarative version of <code class="language-text">{ isTruthy &amp;&amp; &lt;Component /&gt; }</code> kind of things):</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;IfElse.T condition={a &gt; b}&gt;
  &lt;ComponentForTruthy /&gt;
&lt;/IfElse.T&gt;

&lt;IfElse.F condition={a &gt; b}&gt;
  &lt;ComponentForFalsy /&gt;
&lt;/IfElse.F&gt;</code></pre></div>
<p><a href="https://codesandbox.io/s/confident-dream-wvghc">Codesandbox</a></p>
<h3>Testing</h3>
<p>One more positiv argument to build utils is certanity that your code is still working fine after
replacing something because tests are successfully passed. Lets consider one little case.</p>
<p>Take into consideration <code class="language-text">mapId</code> function that we built earlier. It uses <code class="language-text">map</code> and <code class="language-text">prop</code> functions
from <code class="language-text">ramda</code>. It is not so likely but maybe you want to replace <code class="language-text">ramda</code>’s <code class="language-text">map</code> with <code class="language-text">lodash</code>’s <code class="language-text">map</code>.
The second one takes array argument as a first parameter. It means that our <code class="language-text">mapId</code> function will
be broken. We can quickly make test for it and check it once we made a change to an implementation.
With <code class="language-text">lodash</code> it can be reimplemented like that:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'ramda'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> map <span class="token keyword">from</span> <span class="token string">'lodash.map'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapId</span> <span class="token operator">=</span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">map</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> _<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Thats it. Now all your app code that uses this function will receive updated implementation of the
<code class="language-text">mapId</code> function. It was very easy to test and change because of our wrapper for <code class="language-text">ramda</code> and <code class="language-text">lodash</code> libraries.</p>
<p>Ideally all the functions from such library should be exposed through application “util” module. I’m afraid of thinking about
how much work it can bring if at some point we decided to change
third party library. For example from <code class="language-text">lodash</code> to <code class="language-text">ramda</code>, or from <code class="language-text">OneUI</code> to <code class="language-text">TwoUI</code>. Without special util module we’ll have to change almost all files in the application. But with it, only change of specific util files is required.</p>
<h3>Conclusion</h3>
<p>Imagine your app code as three layers of dependencies:</p>
<ol>
<li>application code itself</li>
<li>your utils and tools, wrappers for third party code</li>
<li>third party code itself</li>
</ol>
<p>This approach will make you happier to use your utils and to bring more certanity how it works and
how it can be improved, how third party code can be replaced without pain.</p>
<p>Enjoy coding!</p></div><div class="post-single__date"><em>Published <!-- -->30 Dec 2019</em></div></div><div class="post-single__footer"><div class="post-single__tags"><ul class="post-single__tags-list"><li class="post-single__tags-list-item"><a class="post-single__tags-list-item-link" href="/tags/javascript/">Javascript</a></li><li class="post-single__tags-list-item"><a class="post-single__tags-list-item-link" href="/tags/web/">Web</a></li><li class="post-single__tags-list-item"><a class="post-single__tags-list-item-link" href="/tags/architecture/">Architecture</a></li></ul></div><p class="post-single__footer-text"><a href="https://twitter.com/valeriimaltsev/status/1211386011923730434" target="_blank" rel="noopener noreferrer"><br/> Discuss article on Twitter!</a></p><p class="post-single__footer-text"><a href="https://github.com/ValeriiMal/proginmind.io/blob/master/src/pages/articles/build-your-own-utils.md" target="_blank" rel="noopener noreferrer"><br/> Check it out on Github!</a></p><hr/></div></div></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-template-jsx","jsonName":"posts-build-your-utils-0d1","path":"/posts/build-your-utils/"};window.dataPath="903/path---posts-build-your-utils-0-d-1-df8-aT9JdVinklRjgBL9smkka0gxg";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-f7560001493a17b1aff9.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-b12d9bb3b7a286c12329.js"],"component---src-templates-post-template-jsx":["/component---src-templates-post-template-jsx.e3898ebf0382d24403ff.css","/component---src-templates-post-template-jsx-e87a5a16591bd660b46f.js"],"component---src-templates-tag-template-jsx":["/component---src-templates-tag-template-jsx.69a945a11e23dfafac91.css","/component---src-templates-tag-template-jsx-b6c247e27f17f8eee6ea.js"],"component---src-templates-category-template-jsx":["/component---src-templates-category-template-jsx.69a945a11e23dfafac91.css","/component---src-templates-category-template-jsx-29855c3e555bf87d31cf.js"],"component---src-templates-page-template-jsx":["/component---src-templates-page-template-jsx.bd3413590f4031314c23.css","/component---src-templates-page-template-jsx-4c7a563398dfe420f7e1.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-be8d4bbbfa8071caa88b.js"],"component---src-pages-categories-jsx":["/component---src-pages-categories-jsx-b812208e25350b50652d.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx.69a945a11e23dfafac91.css","/component---src-pages-index-jsx-f4b718ab13d8d2ba3c97.js"],"component---src-pages-tags-jsx":["/component---src-pages-tags-jsx-85cc16106c3baf959b37.js"]};/*]]>*/</script><script src="/webpack-runtime-5956b358f1db043dc6af.js" async=""></script><script src="/0-b8503e2c4e230276dc09.js" async=""></script><script src="/3-33c210f6aea9be8bdf5b.js" async=""></script><script src="/app-f7560001493a17b1aff9.js" async=""></script><script src="/component---src-templates-post-template-jsx-e87a5a16591bd660b46f.js" async=""></script></body></html>